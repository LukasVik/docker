os: linux
services: docker
language: minimal
install: skip
addons:
  apt:
    packages:
      - pass

stages:
  - test
  - vunit

jobs:
  include:
    - &job
      env:
       - TASK="debian"
       - IMAGE=""
      script: ./travis/run.sh -l $TASK
      deploy:
        - provider: script
          skip_cleanup: true
          script: ./travis/run.sh "$IMAGE"
          on:
            repo: ghdl/docker
            branch: ext
    - <<: *job
      env:
       - TASK="ubuntu"
       - IMAGE=""
    - <<: *job
      stage: vunit
      env: IMAGE="ext"
      script: ./travis/run.sh -e
